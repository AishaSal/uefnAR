<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>أرسل جزيرتك | UEFN سطور</title>
  <meta name="description" content="نموذج إرسال الجزر لعرضها في مجتمع UEFN العربي على سطور.">
  <link rel="stylesheet" href="submit.css" />
</head>
<body>

  <!-- Nav -->
  <nav class="nav">
    <a href="/" class="brand"><span>UEFN</span><span> • </span><span>سطور</span></a>
    <div class="actions">
      <a href="/#tutorials">الدروس</a>
      <a href="/#showcase">العروض</a>
      <a href="license.html">الرخصة</a>
      <a href="submit.html" class="cta">أرسل جزيرتك</a>
    </div>
  </nav>

  <!-- Header -->
  <header class="header">
    <h1 class="title">أرسل جزيرتك لعرضها</h1>
    <p class="subtitle">املأ النموذج التالي. بعد المراجعة سنعرض جزيرتك في صفحة العروض مع نظام التصويت.</p>
  </header>

  <!-- Form Card -->
  <section class="card">
    <form id="islandForm" action="https://formspree.io/f/YOUR_FORMSPREE_ENDPOINT" method="POST" novalidate>
      <!-- اسم المبدع -->
      <div class="fld">
        <label for="name">اسمك الكامل <span class="req">*</span></label>
        <input id="name" name="name" type="text" placeholder="مثال: عائشة سال" required />
        <small class="err-msg">يرجى إدخال الاسم.</small>
      </div>

      <!-- بريد للتواصل -->
      <div class="fld">
        <label for="email">البريد الإلكتروني للتواصل <span class="req">*</span></label>
        <input id="email" name="email" type="email" placeholder="you@example.com" required />
        <small class="err-msg">صيغة البريد غير صحيحة.</small>
      </div>

      <!-- حسابات اختيارية -->
      <div class="fld">
        <label for="epic">حساب Epic (اختياري)</label>
        <input id="epic" name="epic" type="text" placeholder="@YourEpicID" />
      </div>

      <div class="fld">
        <label for="discord">ديسكورد (اختياري)</label>
        <input id="discord" name="discord" type="text" placeholder="username#0000" />
      </div>

      <!-- عنوان الجزيرة -->
      <div class="fld">
        <label for="title">عنوان الجزيرة <span class="req">*</span></label>
        <input id="title" name="title" type="text" placeholder="اسم جذاب لجزيرتك" required />
        <small class="err-msg">يرجى إدخال العنوان.</small>
      </div>

      <!-- كود الجزيرة -->
      <div class="fld">
        <label for="code">كود الجزيرة (12 رقمًا مع فواصل) <span class="req">*</span></label>
        <input id="code" name="island_code" type="text" inputmode="numeric"
               placeholder="0000-0000-0000"
               pattern="^\d{4}-\d{4}-\d{4}$" required />
        <small class="hint">مثال صحيح: 1234-5678-9012</small>
        <small class="err-msg">الرجاء استخدام الصيغة 0000-0000-0000.</small>
      </div>

      <!-- الفئة -->
      <div class="fld">
        <label for="category">الفئة</label>
        <select id="category" name="category">
          <option value="battle">قتال / PvP</option>
          <option value="parkour">باركور / حركة</option>
          <option value="story">قصة / مغامرة</option>
          <option value="mini">ميني جيمز</option>
          <option value="training">تدريب / ميكانيكس</option>
          <option value="other">أخرى</option>
        </select>
      </div>

      <!-- صورة أو غلاف -->
      <div class="fld">
        <label for="cover">رابط صورة العرض (Screenshot/Thumbnail) <span class="req">*</span></label>
        <input id="cover" name="cover_url" type="url" placeholder="https://example.com/your-image.jpg" required />
        <small class="err-msg">يرجى إدخال رابط صالح للصورة.</small>
      </div>

      <!-- وصف -->
      <div class="fld row-span-2">
        <label for="desc">وصف قصير للجزيرة <span class="req">*</span></label>
        <textarea id="desc" name="description" placeholder="نبذة عن أسلوب اللعب، الأهداف، عدد اللاعبين، وما يميز جزيرتك..." required></textarea>
        <small class="err-msg">يرجى كتابة وصف مختصر.</small>
      </div>

      <!-- روابط إضافية -->
      <div class="fld">
        <label for="video">رابط فيديو (يوتيوب/تيك توك) — اختياري</label>
        <input id="video" name="video_url" type="url" placeholder="https://youtu.be/..." />
      </div>

      <div class="fld">
        <label for="notes">ملاحظات للمراجعة (اختياري)</label>
        <input id="notes" name="notes" type="text" placeholder="أي تفاصيل إضافية للمراجعين" />
      </div>

      <!-- الموافقة -->
      <div class="fld row-span-2">
        <label><input type="checkbox" name="consent" required /> أوافق على عرض بياناتي (الاسم/روابط عامة) مع بطاقة الجزيرة، وأتحمل مسؤولية حقوق الصور والمحتوى.</label>
        <small class="hint">لن نعرض بريدك علنًا. يمكن إزالة المشاركة لاحقًا عند الطلب.</small>
        <small class="err-msg">الموافقة مطلوبة قبل الإرسال.</small>
      </div>

      <!-- أزرار -->
      <div class="btns row-span-2">
        <button type="submit" class="btn primary">إرسال</button>
        <button type="reset" class="btn secondary">مسح الحقول</button>
      </div>

      <!-- رسائل -->
      <div id="toastOk" class="toast">تم الإرسال بنجاح. شكرًا لك! ✅</div>
      <div id="toastErr" class="toast err">تعذر الإرسال. تأكد من الحقول أو حاول لاحقًا. ❌</div>

      <!-- meta data -->
      <input type="hidden" name="_subject" value="إرسال جزيرة جديدة - UEFN سطور"/>
      <input type="hidden" name="source" value="uefn.satoor.fun"/>
    </form>
  </section>

  <p class="note">
    ملاحظة: فعّل <strong>Formspree</strong> ثم استبدل <code>YOUR_FORMSPREE_ENDPOINT</code> في الخاصية <code>action</code>.
  </p>

  <script>
    // Client-side validation + AJAX submit to keep user on page
    const form = document.getElementById('islandForm');
    const ok = document.getElementById('toastOk');
    const err = document.getElementById('toastErr');

    function showError(input, show) {
      const field = input.closest('.fld');
      const msg = field?.querySelector('.err-msg');
      if (msg) msg.style.display = show ? 'block' : 'none';
    }

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      ok.style.display = 'none'; err.style.display = 'none';

      // simple validation display
      let valid = true;
      [...form.elements].forEach(el => {
        if (el.hasAttribute('required')) {
          const isOK = el.type === 'checkbox' ? el.checked : !!el.value.trim();
          showError(el, !isOK);
          if (!isOK) valid = false;
        }
        if (el.id === 'code' && el.value && !/^\d{4}-\d{4}-\d{4}$/.test(el.value)) {
          showError(el, true); valid = false;
        }
      });
      if (!valid) { err.style.display = 'block'; return; }

      const endpoint = form.getAttribute('action');
      if (!endpoint || endpoint.includes('YOUR_FORMSPREE_ENDPOINT')) {
        err.textContent = 'يرجى تفعيل Formspree واستبدال رابط الإرسال.';
        err.style.display = 'block';
        return;
      }

      try {
        const data = new FormData(form);
        const res = await fetch(endpoint, { method: 'POST', headers: { 'Accept':'application/json' }, body: data });
        if (res.ok) {
          form.reset();
          ok.style.display = 'block';
        } else {
          err.style.display = 'block';
        }
      } catch {
        err.style.display = 'block';
      }
    });

    // hide error on input
    form.addEventListener('input', (e) => {
      if (e.target.closest('.fld')) showError(e.target, false);
    });
  </script>
</body>
</html>
